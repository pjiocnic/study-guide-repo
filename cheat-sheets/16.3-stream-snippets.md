
```java
public class TourManager {
    private final TreeSet<TourPackage> vacations;

    public TourManager() {
        this.vacations = new TreeSet<>(Comparator.comparing(TourPackage::getOfferDate));
    }

    public void addPackage(TourPackage newPackage) {
        // First, terminate packages based on the operator of the new package
        if (newPackage.getOperators().contains(Operator.OPERATOR_B)) {
            // Terminate all packages from Operator A if Operator B's package arrives
            vacations.stream()
                    .filter(pkg -> pkg.getOperators().contains(Operator.OPERATOR_A))
                    .forEach(pkg -> pkg.setTerminationDate(LocalDate.now()));
        } else if (newPackage.getOperators().contains(Operator.OPERATOR_A)) {
            // If Operator A's package arrives, only terminate older packages from Operator A
            vacations.stream()
                    .filter(pkg -> pkg.getOperators().contains(Operator.OPERATOR_A) && pkg.getTerminationDate() == null)
                    .forEach(pkg -> pkg.setTerminationDate(LocalDate.now()));
        }

        // If the new package from OperatorB arrives, leave it non-terminated, terminate any other active OperatorA
        Optional<TourPackage> activePackageFromB = vacations.stream()
                .filter(pkg -> pkg.getOperators().contains(Operator.OPERATOR_B) && pkg.getTerminationDate() == null)
                .findFirst();

        if (newPackage.getOperators().contains(Operator.OPERATOR_A) && activePackageFromB.isPresent()) {
            // If there is an active package from Operator B, terminate the new package from Operator A
            newPackage.setTerminationDate(LocalDate.now());
        } else {
            // Otherwise, add the new package as non-terminated
            newPackage.setTerminationDate(null);
        }

        // Add the new package to the collection
        vacations.add(newPackage);
    }

    public TreeSet<TourPackage> getVacations() {
        return vacations;
    }
}

```

- Junit

```java
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

import java.time.LocalDate;
import java.util.Optional;

import static org.junit.jupiter.api.Assertions.*;

class TourManagerTest {

    private TourManager tourManager;

    @BeforeEach
    void setUp() {
        tourManager = new TourManager();
    }

    @Test
    void testAddFirstPackage() {
        // First time adding a package from OperatorA
        TourPackage packageA = new TourPackage("Summer Vacation", LocalDate.of(2024, 7, 1), Operator.OPERATOR_A);
        tourManager.addPackage(packageA);

        // Verify that the package is added and not terminated
        Optional<TourPackage> activePackage = tourManager.getVacations().stream().findFirst();
        assertTrue(activePackage.isPresent());
        assertEquals("Summer Vacation", activePackage.get().getVacationName());
        assertNull(activePackage.get().getTerminationDate());
    }

    @Test
    void testAddSameVacationFromDifferentOperator() {
        // Adding a package from OperatorA
        TourPackage packageA = new TourPackage("Winter Vacation", LocalDate.of(2024, 1, 1), Operator.OPERATOR_A);
        tourManager.addPackage(packageA);

        // Adding the same vacation from OperatorB
        TourPackage packageB = new TourPackage("Winter Vacation", LocalDate.of(2024, 1, 15), Operator.OPERATOR_B);
        tourManager.addPackage(packageB);

        // Verify that the package now contains both operators
        Optional<TourPackage> activePackage = tourManager.getVacations().stream().findFirst();
        assertTrue(activePackage.isPresent());
        assertTrue(activePackage.get().getOperators().contains(Operator.OPERATOR_A));
        assertTrue(activePackage.get().getOperators().contains(Operator.OPERATOR_B));
    }

    @Test
    void testOperatorBReplacesOperatorA() {
        // Add a package from OperatorA
        TourPackage packageA = new TourPackage("Beach Vacation", LocalDate.of(2024, 6, 1), Operator.OPERATOR_A);
        tourManager.addPackage(packageA);

        // Add a different package from OperatorB
        TourPackage packageB = new TourPackage("Mountain Retreat", LocalDate.of(2024, 6, 10), Operator.OPERATOR_B);
        tourManager.addPackage(packageB);

        // Verify that the package from Operator A is terminated and B is active
        Optional<TourPackage> activePackage = tourManager.getVacations().stream().filter(pkg -> pkg.getTerminationDate() == null).findFirst();
        assertTrue(activePackage.isPresent());
        assertEquals("Mountain Retreat", activePackage.get().getVacationName());
        assertTrue(activePackage.get().getOperators().contains(Operator.OPERATOR_B));

        // Check that the previous package from Operator A is terminated
        Optional<TourPackage> terminatedPackage = tourManager.getVacations().stream().filter(pkg -> pkg.getTerminationDate() != null).findFirst();
        assertTrue(terminatedPackage.isPresent());
        assertEquals("Beach Vacation", terminatedPackage.get().getVacationName());
    }

    @Test
    void testOperatorAReplacesOperatorA() {
        // Add a package from OperatorA
        TourPackage packageA = new TourPackage("Cruise Vacation", LocalDate.of(2024, 3, 1), Operator.OPERATOR_A);
        tourManager.addPackage(packageA);

        // Add a different package from OperatorA with a later offer date
        TourPackage packageA2 = new TourPackage("Safari Adventure", LocalDate.of(2024, 4, 1), Operator.OPERATOR_A);
        tourManager.addPackage(packageA2);

        // Verify that the latest package from Operator A is active
        Optional<TourPackage> activePackage = tourManager.getVacations().stream().filter(pkg -> pkg.getTerminationDate() == null).findFirst();
        assertTrue(activePackage.isPresent());
        assertEquals("Safari Adventure", activePackage.get().getVacationName());

        // Verify that the older package from Operator A is terminated
        Optional<TourPackage> terminatedPackage = tourManager.getVacations().stream().filter(pkg -> pkg.getTerminationDate() != null).findFirst();
        assertTrue(terminatedPackage.isPresent());
        assertEquals("Cruise Vacation", terminatedPackage.get().getVacationName());
    }

    @Test
    void testOperatorAAddedWhenOperatorBIsActive() {
        // Add a package from OperatorB
        TourPackage packageB = new TourPackage("City Tour", LocalDate.of(2024, 2, 1), Operator.OPERATOR_B);
        tourManager.addPackage(packageB);

        // Add a different package from OperatorA
        TourPackage packageA = new TourPackage("Desert Safari", LocalDate.of(2024, 3, 15), Operator.OPERATOR_A);
        tourManager.addPackage(packageA);

        // Verify that the package from OperatorB is still active and OperatorA package is terminated
        Optional<TourPackage> activePackage = tourManager.getVacations().stream().filter(pkg -> pkg.getTerminationDate() == null).findFirst();
        assertTrue(activePackage.isPresent());
        assertEquals("City Tour", activePackage.get().getVacationName());
        assertTrue(activePackage.get().getOperators().contains(Operator.OPERATOR_B));

        // Check that the package from Operator A is terminated
        Optional<TourPackage> terminatedPackage = tourManager.getVacations().stream().filter(pkg -> pkg.getTerminationDate() != null).findFirst();
        assertTrue(terminatedPackage.isPresent());
        assertEquals("Desert Safari", terminatedPackage.get().getVacationName());
    }

    @Test
    void testSameOperatorWithDifferentPackage() {
        // Add a package from OperatorB
        TourPackage packageB1 = new TourPackage("Forest Trek", LocalDate.of(2024, 5, 1), Operator.OPERATOR_B);
        tourManager.addPackage(packageB1);

        // Add a new package from OperatorB with a later offer date
        TourPackage packageB2 = new TourPackage("Island Retreat", LocalDate.of(2024, 6, 20), Operator.OPERATOR_B);
        tourManager.addPackage(packageB2);

        // Verify that the second package from OperatorB is active
        Optional<TourPackage> activePackage = tourManager.getVacations().stream().filter(pkg -> pkg.getTerminationDate() == null).findFirst();
        assertTrue(activePackage.isPresent());
        assertEquals("Island Retreat", activePackage.get().getVacationName());

        // Verify that the first package from OperatorB is terminated
        Optional<TourPackage> terminatedPackage = tourManager.getVacations().stream().filter(pkg -> pkg.getTerminationDate() != null).findFirst();
        assertTrue(terminatedPackage.isPresent());
        assertEquals("Forest Trek", terminatedPackage.get().getVacationName());
    }

    @Test
    void testOperatorAAndOperatorBWithNewOfferFromOperatorA() {
        // Add a package from OperatorA
        TourPackage packageA = new TourPackage("City Tour", LocalDate.of(2024, 3, 1), Operator.OPERATOR_A);
        tourManager.addPackage(packageA);

        // Add a package from OperatorB
        TourPackage packageB = new TourPackage("Beach Retreat", LocalDate.of(2024, 3, 10), Operator.OPERATOR_B);
        tourManager.addPackage(packageB);

        // Add another package from OperatorA
        TourPackage packageA2 = new TourPackage("Forest Trek", LocalDate.of(2024, 4, 1), Operator.OPERATOR_A);
        tourManager.addPackage(packageA2);

        // Verify that both OperatorA packages are terminated, and OperatorB is still active
        Optional<TourPackage> activePackage = tourManager.getVacations().stream().filter(pkg -> pkg.getTerminationDate() == null).findFirst();
        assertTrue(activePackage.isPresent());
        assertEquals("Beach Retreat", activePackage.get().getVacationName());
        assertTrue(activePackage.get().getOperators().contains(Operator.OPERATOR_B));

        // Verify that both OperatorA packages are terminated
        long terminatedPackagesA = tourManager.getVacations().stream()
                .filter(pkg -> pkg.getOperators().contains(Operator.OPERATOR_A) && pkg.getTerminationDate() != null)
                .count();
        assertEquals(2, terminatedPackagesA);
    }

}

```