
To allow Lambda functions to communicate with resources within a VPC (including a Network Load Balancer), you indeed need to configure a VPC interface for your Lambda function. Here's the key information about this: [1]

**1. VPC Interface:**

  * Lambda functions by default run in an AWS-managed VPC and don't have access to resources in your own VPCs. [2]

  * To enable communication with resources in your VPC (like your NLB), you need to configure your Lambda function to use a VPC interface.

**2. How it works:**

  * When you configure a Lambda function with a VPC interface, AWS creates Elastic Network Interfaces (ENIs) in your VPC subnets.

  * These ENIs allow your Lambda function to connect to other resources within your VPC. [3]

**3. Configuration requirements**:

  * You need to specify at least one subnet in your VPC.

  * You must also specify one or more security groups.

**4. Important considerations**:

  * When a Lambda function is configured with a VPC interface, it loses default internet access. If you need internet access, you'll need to configure a NAT gateway or use VPC endpoints.

  * There's a slight increase in cold start times for Lambda functions with VPC interfaces.

To configure your Lambda function with a VPC interface, you can do the following:

1. In the AWS Lambda console:

  * Go to your function's configuration.

  * In the "Network" section, choose "VPC".

  * Select your VPC, subnets, and security groups.

2. Using AWS CLI: You can use a command like this:

```bash
aws lambda update-function-configuration \
  --function-name YourFunctionName \
  --vpc-config SubnetIds=subnet-xxxx,subnet-yyyy,SecurityGroupIds=sg-zzzz
```

In AWS CloudFormation: You can specify the VPC configuration in your Lambda function resource:

```yaml
MyLambdaFunction:
  Type: AWS::Lambda::Function
  Properties:
    # ... other properties ...
    VpcConfig:
      SecurityGroupIds:
        - sg-xxxxxxxxxxxxxxxxx
      SubnetIds:
        - subnet-xxxxxxxxxxxxxxxxx
        - subnet-yyyyyyyyyyyyyyyyy
```

After configuring the VPC interface, make sure:

  * The selected subnets can route to the subnets where your NLB is located.

  * The security group allows outbound traffic to the NLB.

  * The NLB's security group allows inbound traffic from the Lambda's security group.

This VPC interface configuration is likely the missing piece that's preventing your Lambda function from communicating with the NLB. Once properly configured, your Lambda should be able to reach the NLB within the VPC network, just as it would reach any other internal resource.

### References

1. [Networking and VPC configurations](https://docs.aws.amazon.com/lambda/latest/operatorguide/networking-vpc.html)
2. [Frequently asked questions](https://docs.aws.amazon.com/lambda/latest/operatorguide/security-ops-faq.html)
3. [Access logs for your Application Load Balancer](https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html)


### How to check if the Lambda function has a VPC endpoint configured to communicate with a Network Load Balancer (NLB) in your VPC

To check if your Lambda function has a VPC endpoint configured to communicate with a Network Load Balancer (NLB) in your VPC, you'll need to look at a few different aspects of your Lambda configuration and VPC setup. Here's how you can check: [1]

Lambda Function Configuration: First, check if your Lambda function is configured to run within a VPC. You can do this in the AWS Management Console or using the AWS CLI. [2]Using the AWS CLI, you can run:

```bash
aws lambda get-function-configuration --function-name YOUR_FUNCTION_NAME
```

Look for the "VpcConfig" section in the output. If it's present and contains subnet IDs and security group IDs, your function is configured to run in a VPC.
VPC Endpoints: Next, check if you have a VPC endpoint for Lambda in your VPC. VPC endpoints allow your resources within the VPC to communicate with Lambda without going through the public internet.You can check this in the VPC section of the AWS Management Console or using the AWS CLI:

```bash
aws ec2 describe-vpc-endpoints --filters Name=service-name,Values=com.amazonaws.YOUR_REGION.lambda
```

Replace YOUR_REGION with your AWS region (e.g., us-east-1).
Network Load Balancer Configuration: Ensure your NLB is properly configured in your VPC and that its target group includes the private IP addresses of the Lambda function's ENIs (Elastic Network Interfaces). [3]

**Security Group Rules:** Check that the security groups associated with your Lambda function and NLB allow the necessary inbound and outbound traffic.

**Route Tables:** Verify that the route tables for the subnets where your Lambda function and NLB are located have the correct routes to allow traffic between them.

**CloudWatch Logs:** If your Lambda function is attempting to communicate with the NLB, you might see relevant log entries in CloudWatch Logs. Check the function's log group for any connection-related messages.

**AWS CloudTrail:** You can use CloudTrail to check for API calls related to VPC configurations for your Lambda function.

Remember, Lambda functions don't directly have VPC endpoints configured. Instead, they are configured to run within a VPC, and then VPC endpoints are set up in that VPC to allow communication with AWS services.

If you're using a VPC endpoint to allow your Lambda function to communicate with other AWS services without going through the public internet, you would configure this at the VPC level, not directly on the Lambda function.

If you need to make any changes to your Lambda function's VPC configuration, you can use the update-function-configuration AWS CLI command or the corresponding API/SDK method.